<?wtrjXml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jin.admin.dao.mapper.SysMenuMapper">

    <select id="getMenuByUserId" resultType="com.jin.admin.response.MenuData">
        select
            m.*, mr.sort_num
        from sys_user_role_rel ur join sys_role r on ur.role_id = r.id
        join sys_role_permission_rel rp on r.id = rp.role_id
        join sys_permission p on rp.permission_id = p.id
        join sys_permission_resource_rel rr on rr.permission_id = p.id
        join sys_menu m on rr.resource_id = m.id
        join sys_menu_sort_rel mr on mr.menu_id = m.id
        where r.status = 1 and p.status =1 and m.status = 1
        and rr.type = 9
        <if test="userId != 1">
            and ur.user_id = #{userId}
        </if>
    </select>
</mapper>
